<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>äº¤æ¥æ–‡æ¡£ | Eric&#39;s Docs</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/vim-go.png">
    <meta name="description" content="Vue é©±åŠ¨çš„é™æ€ç½‘ç«™ç”Ÿæˆå™¨">
    
    <link rel="preload" href="/assets/css/0.styles.e8e4f3a3.css" as="style"><link rel="preload" href="/assets/js/app.449b22a3.js" as="script"><link rel="preload" href="/assets/js/2.559d5401.js" as="script"><link rel="preload" href="/assets/js/15.ec9227b5.js" as="script"><link rel="prefetch" href="/assets/js/10.726bd935.js"><link rel="prefetch" href="/assets/js/11.e79855c3.js"><link rel="prefetch" href="/assets/js/12.47f2790b.js"><link rel="prefetch" href="/assets/js/13.417251e4.js"><link rel="prefetch" href="/assets/js/14.3edae8b6.js"><link rel="prefetch" href="/assets/js/16.26fb3b70.js"><link rel="prefetch" href="/assets/js/17.29790a45.js"><link rel="prefetch" href="/assets/js/18.b0df4d31.js"><link rel="prefetch" href="/assets/js/19.bc5e31dd.js"><link rel="prefetch" href="/assets/js/20.b2d6c07e.js"><link rel="prefetch" href="/assets/js/21.a977319a.js"><link rel="prefetch" href="/assets/js/22.6b11c997.js"><link rel="prefetch" href="/assets/js/23.6addca62.js"><link rel="prefetch" href="/assets/js/24.8f666926.js"><link rel="prefetch" href="/assets/js/3.e9d031a5.js"><link rel="prefetch" href="/assets/js/4.f16d5533.js"><link rel="prefetch" href="/assets/js/5.905f59dc.js"><link rel="prefetch" href="/assets/js/6.2f60c27c.js"><link rel="prefetch" href="/assets/js/7.12fb85ab.js"><link rel="prefetch" href="/assets/js/8.047bdcbd.js"><link rel="prefetch" href="/assets/js/9.a153bdbb.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e8e4f3a3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/vim-go.png" alt="Eric's Docs" class="logo"> <span class="site-name can-hide">Eric's Docs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Guide" class="dropdown-title"><span class="title">Guide</span> <span class="arrow down"></span></button> <button type="button" aria-label="Guide" class="mobile-dropdown-title"><span class="title">Guide</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          è¶…é«˜æ¸…èƒ½åŠ›
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/è¶…é«˜æ¸…èƒ½åŠ›/äº¤æ¥æ–‡æ¡£.html" class="nav-link">
  äº¤æ¥æ–‡æ¡£
</a></li><li class="dropdown-subitem"><a href="/è¶…é«˜æ¸…èƒ½åŠ›/æ¬è¿ç»„ä»¶è¯´æ˜æ–‡æ¡£.html" class="nav-link">
  æ¬è¿æ–‡æ¡£
</a></li><li class="dropdown-subitem"><a href="/è¶…é«˜æ¸…èƒ½åŠ›/Dvadmin æ¥å£.html" class="nav-link">
  Dvadminæ¥å£
</a></li><li class="dropdown-subitem"><a href="/è¶…é«˜æ¸…èƒ½åŠ›/RDæŠ¥å‘Šæ¥å£æ–‡æ¡£.html" class="nav-link">
  RDæŠ¥å‘Šæ¥å£æ–‡æ¡£
</a></li></ul></li><li class="dropdown-item"><h4>
          è¿ç»´éƒ¨ç½²
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/è¿ç»´éƒ¨ç½²/Docker.html" class="nav-link">
  Docker
</a></li></ul></li><li class="dropdown-item"><h4>
          é¢ç»
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/é¢è¯•/é¢ç».html" class="nav-link">
  é¢ç»
</a></li></ul></li><li class="dropdown-item"><h4>
          odoo
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/odoo/odooæ ¸å¿ƒä¸šåŠ¡.html" class="nav-link">
  odooæ ¸å¿ƒä¸šåŠ¡
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/eric-jxl/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/eric-jxl/docs.git" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Guide" class="dropdown-title"><span class="title">Guide</span> <span class="arrow down"></span></button> <button type="button" aria-label="Guide" class="mobile-dropdown-title"><span class="title">Guide</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          è¶…é«˜æ¸…èƒ½åŠ›
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/è¶…é«˜æ¸…èƒ½åŠ›/äº¤æ¥æ–‡æ¡£.html" class="nav-link">
  äº¤æ¥æ–‡æ¡£
</a></li><li class="dropdown-subitem"><a href="/è¶…é«˜æ¸…èƒ½åŠ›/æ¬è¿ç»„ä»¶è¯´æ˜æ–‡æ¡£.html" class="nav-link">
  æ¬è¿æ–‡æ¡£
</a></li><li class="dropdown-subitem"><a href="/è¶…é«˜æ¸…èƒ½åŠ›/Dvadmin æ¥å£.html" class="nav-link">
  Dvadminæ¥å£
</a></li><li class="dropdown-subitem"><a href="/è¶…é«˜æ¸…èƒ½åŠ›/RDæŠ¥å‘Šæ¥å£æ–‡æ¡£.html" class="nav-link">
  RDæŠ¥å‘Šæ¥å£æ–‡æ¡£
</a></li></ul></li><li class="dropdown-item"><h4>
          è¿ç»´éƒ¨ç½²
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/è¿ç»´éƒ¨ç½²/Docker.html" class="nav-link">
  Docker
</a></li></ul></li><li class="dropdown-item"><h4>
          é¢ç»
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/é¢è¯•/é¢ç».html" class="nav-link">
  é¢ç»
</a></li></ul></li><li class="dropdown-item"><h4>
          odoo
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/odoo/odooæ ¸å¿ƒä¸šåŠ¡.html" class="nav-link">
  odooæ ¸å¿ƒä¸šåŠ¡
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/eric-jxl/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/eric-jxl/docs.git" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>è¶…é«˜æ¸…èƒ½åŠ›</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/è¶…é«˜æ¸…èƒ½åŠ›/æ¬è¿ç»„ä»¶è¯´æ˜æ–‡æ¡£.html" class="sidebar-link">æ¬è¿ç»„ä»¶è¯´æ˜æ–‡æ¡£</a></li><li><a href="/è¶…é«˜æ¸…èƒ½åŠ›/äº¤æ¥æ–‡æ¡£.html" class="active sidebar-link">äº¤æ¥æ–‡æ¡£</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/è¶…é«˜æ¸…èƒ½åŠ›/DTing VQMT VQAéƒ¨ç½²å¸¸è§é—®é¢˜.html" class="sidebar-link">DTing VQMT VQAéƒ¨ç½²å¸¸è§é—®é¢˜</a></li><li><a href="/è¶…é«˜æ¸…èƒ½åŠ›/Dvadmin æ¥å£.html" class="sidebar-link">æ ‡ç­¾</a></li><li><a href="/è¶…é«˜æ¸…èƒ½åŠ›/RDæŠ¥å‘Šæ¥å£æ–‡æ¡£.html" class="sidebar-link">RD æŠ¥å‘Š API æ–‡æ¡£</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>è¿ç»´éƒ¨ç½²</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/è¿ç»´éƒ¨ç½²/Docker.html" class="sidebar-link">Docker</a></li><li><a href="/è¿ç»´éƒ¨ç½²/Golang Ubuntuå®‰è£…åŠé…ç½®.html" class="sidebar-link">Golang Ubuntuå®‰è£…åŠé…ç½®</a></li><li><a href="/è¿ç»´éƒ¨ç½²/Jupyter è¿œç¨‹é…ç½®.html" class="sidebar-link">Jupyter è¿œç¨‹é…ç½®</a></li><li><a href="/è¿ç»´éƒ¨ç½²/nacoså®‰è£…æŒ‡å—.html" class="sidebar-link">nacoså®‰è£…æŒ‡å—</a></li><li><a href="/è¿ç»´éƒ¨ç½²/RedisDoc.html" class="sidebar-link">Redis å®‰è£…ä¸é…ç½®</a></li><li><a href="/è¿ç»´éƒ¨ç½²/Ubuntuéƒ¨ç½².html" class="sidebar-link">Ubuntu éƒ¨ç½²nginxã€ç”Ÿæˆæ³›åŸŸåè¯ä¹¦</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>odoo</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/odoo/å·¡æ£€ä»»åŠ¡æ¥å£.html" class="sidebar-link">å·¡æ£€ä»»åŠ¡æŸ¥è¯¢æ¥å£</a></li><li><a href="/odoo/odooæ ¸å¿ƒä¸šåŠ¡.html" class="sidebar-link">æ ¸å¿ƒä¸šåŠ¡</a></li><li><a href="/odoo/OdooåŠPostgresql.html" class="sidebar-link">OdooåŠPostgresql</a></li><li><a href="/odoo/odooconf.html" class="sidebar-link">Odoo Sever Config</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="äº¤æ¥æ–‡æ¡£"><a href="#äº¤æ¥æ–‡æ¡£" class="header-anchor">#</a> äº¤æ¥æ–‡æ¡£</h1> <h3 id="é¢„ç®—"><a href="#é¢„ç®—" class="header-anchor">#</a> é¢„ç®—</h3> <p>Moudule:rh_account_budget</p> <p>1.<code>conf</code></p> <div class="language- extra-class"><pre><code>å­˜æ”¾redisé…ç½®æ–‡ä»¶
</code></pre></div><p>2.<code>contrlollers</code></p> <p>â€‹	==main.py==  class SyncBudgetReport:</p> <p>â€‹	Route:/api/get_crossovered_budget  : é¢„ç®—æ±‡æ€»æƒ…å†µ  è¿”å›:<code>json</code></p> <p>â€‹	Route:/api/get_account_budget_post: é¢„ç®—çŠ¶å†µæ±‡æ€»è¡¨</p> <p>3.<code>lib</code></p> <p>â€‹	==jwt_utils.py== :å°è£…æ¥å£åŠ å¯†æœºåˆ¶</p> <p>â€‹</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> sha256base64
<span class="token comment">#å¯†é’¥åŠ å¯†ç®—æ³•</span>
<span class="token keyword">def</span> verify_token
<span class="token comment">#æ ¡éªŒtokenè£…é¥°å™¨</span>
</code></pre></div><p>â€‹	 ==redislib.py== ï¼šå°è£…äº†æ‰€æœ‰redisçš„è¿æ¥æ± å’Œæ¥å£</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">ExportRedis</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">insert_redis_queue</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> queue<span class="token punctuation">,</span> params_dict<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''ç”±å·¦å‘å³ğŸ‘‰æ’å…¥List'''</span>
        self<span class="token punctuation">.</span>cursor<span class="token punctuation">.</span>lpush<span class="token punctuation">(</span>queue<span class="token punctuation">,</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>params_dict<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">rpop_redis_queue</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> queue<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''ä»å³å‘å·¦å¼¹å‡º return []'''</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>cursor<span class="token punctuation">.</span>rpop<span class="token punctuation">(</span>queue<span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">range_queue</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> queue<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># æŸ¥è¯¢åˆ—è¡¨ä¸­æ‰€æœ‰çš„é”®å€¼</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>cursor<span class="token punctuation">.</span>lrange<span class="token punctuation">(</span>queue<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre></div><ol start="4"><li><p><code>Models</code></p> <p>==account_budget_modify.py==:ä¸»è¦åŠŸèƒ½ç‚¹ï¼šè¡¨ï¼š==crossovered.budget.lines==é¢„ç®—æ˜ç»†è¡¨</p> <p>planned_amount  è®¡åˆ’é‡‘é¢ practical_amount å®é™…é‡‘é¢  ==new_practical_amount==  æ ¹æ®practical_amountå®é™…é‡‘é¢writeå›å¡«    balance ä½™é¢ã€‚show_color ï¼šæ§åˆ¶åˆ—è¡¨å˜çº¢</p> <p>done_per å®Œæˆç‡</p> <p>==def _compute_practical_amount== è®¡ç®—å®é™…é‡‘é¢ï¼Œæ ¹æ®åˆ†æè´¦æˆ·æ˜ç»†ä¸­ è¯¥åˆ†æè´¦æˆ·åœ¨æ—¥æœŸåŒºé—´å†…æœ‰çš„<code>é¢„ç®—çŠ¶å†µ</code> è¿›è¡ŒSUMè®¡ç®—</p> <p>==budget_hr_expense.py== ï¼šç»§æ‰¿hr.expense.sheet å¯¹è´¹ç”¨å•æ®è¿›è¡Œé¢„ç®—è¶…æ”¯<code>é¢„è­¦å¼¹å‡ºæ¡†</code>,åœ¨do_sumbitå’Œdo_approved å–é¢„ç®—çš„ä½™é¢å’Œå½“å‰åœ¨å¾…æ‰¹å’Œå®Œæˆçš„å•æ®å‘ç”Ÿé¢è¿›è¡Œæ¯”è¾ƒï¼Œ==è¶…çš„æ˜ç»†è¡Œå˜çº¢å¹¶ä¸”å¼¹å‡ºæç¤ºæ¡†==</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">HrExpense</span>
module_budget_installed <span class="token comment">#æ£€æŸ¥é¢„ç®—æ¨¡å—æ˜¯å¦å®‰è£…ï¼Œæœ‰åˆ†æè´¦æˆ·å¿…å¡«</span>
excess_color  <span class="token comment">#è®¡ç®—å­—æ®µ compute_excess_color</span>
	<span class="token keyword">def</span> <span class="token function">compute_module_budget_installed</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> record <span class="token keyword">in</span> self<span class="token punctuation">:</span>
            module <span class="token operator">=</span> self<span class="token punctuation">.</span>env<span class="token punctuation">[</span><span class="token string">'ir.module.module'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>sudo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'='</span><span class="token punctuation">,</span> 		<span class="token string">'rh_account_budget'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> record<span class="token punctuation">.</span>payment_mode <span class="token operator">==</span> <span class="token string">'own_account'</span><span class="token punctuation">:</span> <span class="token comment">#å±äºæŠ¥é”€ç±»å‹</span>
              <span class="token comment">#  ä¸‹é¢æ ¹æ®æƒ…å†µåˆ†é¢„ç®—å†…/é¢„ç®—å¤–</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span> <span class="token comment">#è‡ªåŠ¨æ‰£æ¬¾</span>
                record<span class="token punctuation">.</span>module_budget_installed <span class="token operator">=</span> <span class="token boolean">False</span>
     
	<span class="token keyword">def</span>  compute_excess_color <span class="token comment">#æ§åˆ¶æ˜ç»†è¡Œå˜çº¢</span>
    
    <span class="token keyword">def</span> action_to_analytic_formï¼š<span class="token comment">#è·³è½¬åˆ°å¯¹åº”çš„åˆ†æè´¦æˆ·ç•Œé¢</span>
    
    <span class="token keyword">def</span> edit_expense_line_analytic <span class="token punctuation">:</span><span class="token comment">#ä¿®æ”¹åˆ†æè´¦æˆ·ä¸Šanalytic_account_id</span>
        
</code></pre></div><p>==inherit_analytic_account.py== ï¼šå¯¹åˆ†æè´¦æˆ·åŠŸèƒ½ç»§æ‰¿</p> <p>â€‹	<code>department_ids</code>ï¼šéƒ¨é—¨  <code>user_ids</code>ï¼šå‘˜å·¥    <code>department_user_ids</code>ï¼šéƒ¨é—¨ä¸‹çš„å‘˜å·¥</p> <p>â€‹	æ ¹æ®éƒ¨é—¨é€‰æ‹©ä¸‹å±å‘˜å·¥å¯è§ï¼Œæˆ–è€…ç›´æ¥é€‰æ‹©å‘˜å·¥ï¼Œé™åˆ¶è®°å½•è§„åˆ™</p> <p>â€‹	def compute_user_ids :è®¡ç®—éƒ¨é—¨çš„å‘˜å·¥</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#é‡å†™åˆ†ç»„å‡½æ•°ã€‚ç”¨æ¥è®¡ç®—é¢„ç®—çš„å®é™…é‡‘é¢ã€å ç”¨é‡‘é¢ã€ä½™é¢</span>
<span class="token keyword">def</span> <span class="token function">read_group</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> domain<span class="token punctuation">,</span> fields<span class="token punctuation">,</span> groupby<span class="token punctuation">,</span> offset<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> limit<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> orderby<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> lazy<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        res <span class="token operator">=</span> <span class="token builtin">super</span><span class="token punctuation">(</span>AccountAnalyticAccount<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>read_group<span class="token punctuation">(</span>domain<span class="token punctuation">,</span> fields<span class="token punctuation">,</span> groupby<span class="token punctuation">,</span> offset<span class="token operator">=</span>offset<span class="token punctuation">,</span> limit<span class="token operator">=</span>limit<span class="token punctuation">,</span>
                                                             orderby<span class="token operator">=</span>orderby<span class="token punctuation">,</span> lazy<span class="token operator">=</span>lazy<span class="token punctuation">)</span>
        <span class="token keyword">for</span> r <span class="token keyword">in</span> res<span class="token punctuation">:</span>
            domain <span class="token operator">=</span> r<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'__domain'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            records <span class="token operator">=</span> self<span class="token punctuation">.</span>search<span class="token punctuation">(</span>domain<span class="token punctuation">)</span>
            r<span class="token punctuation">[</span><span class="token string">'budget_planned_amount'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>records<span class="token punctuation">.</span>mapped<span class="token punctuation">(</span><span class="token string">'budget_planned_amount'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token number">0.0</span>
            r<span class="token punctuation">[</span><span class="token string">'budget_amount'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>records<span class="token punctuation">.</span>mapped<span class="token punctuation">(</span><span class="token string">'budget_amount'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token number">0.0</span>
            r<span class="token punctuation">[</span><span class="token string">'budget_balance'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>records<span class="token punctuation">.</span>mapped<span class="token punctuation">(</span><span class="token string">'budget_balance'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token number">0.0</span>
            r<span class="token punctuation">[</span><span class="token string">'occupy_amount'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>records<span class="token punctuation">.</span>mapped<span class="token punctuation">(</span><span class="token string">'occupy_amount'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token number">0.0</span> <span class="token comment">#å ç”¨é‡‘é¢</span>

        <span class="token keyword">return</span> res
    
<span class="token keyword">def</span> <span class="token function">summary_analytic_records</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment">#è®¡ç®—è¯¥åˆ†æè´¦æˆ·å…³è”çš„è´¹ç”¨å•æ®çš„å‘ç”Ÿé¢</span>
<span class="token keyword">def</span> <span class="token function">click_details_windows</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#è·³è½¬æŒ‰é’®ï¼ŒåµŒå¥—ä¸Šé¢çš„æ–¹æ³•ï¼Œæ¯æ¬¡ç‚¹å‡»åˆ é™¤æ—§çºªå½•ï¼Œç”Ÿæˆæ–°çºªå½•ï¼Œç­›é€‰å½“å‰çš„åˆ†æè´¦æˆ·</span>
</code></pre></div><p>â€‹</p></li> <li><p><code>wizard</code></p> <p>ä¸´æ—¶è¡¨æä¾›å‘å¯¼åŠŸèƒ½</p> <p>==wizard_analysis_examine_details.py== åˆ†æè´¦æˆ·ä½¿ç”¨çš„è¯¦æƒ…</p> <p>==wizard_batch_dept_users.py==:æ›´æ–°éƒ¨é—¨ä¸‹çš„å‘˜å·¥</p> <p>==wizard_edit_expense_line_analytic.py==ï¼šä¿®æ”¹åˆ†æè´¦æˆ·æ˜ç»†è¡Œ</p> <p>==wizard_hr_expense_sheet_budget.py==:è´¹ç”¨å®¡æ‰¹å’Œæäº¤ã€‚åˆ¤æ–­æ˜¯å¦è¶…æ”¯é‡‘è¶</p></li></ol> <h3 id="é‡‘è¶"><a href="#é‡‘è¶" class="header-anchor">#</a> é‡‘è¶</h3> <p><code>Module</code>:rh_kingdee_port</p> <ol><li><p>Data:<code>kingdee_ir_corn.xml</code>ï¼šå®šæ—¶ä»»åŠ¡ï¼š<code>è´¹ç”¨å•æ®æ¨é€è´¦æ— å¿§</code>,<code>æ”¶ä»˜æ¬¾å•æ®æ¨é€è´¦æ— å¿§</code>,<code>å†…éƒ¨è½¬è´¦å•æ®æ¨é€è´¦æ— å¿§</code></p> <p><code>kingdee_setting.yml</code>ï¼šè‡ªåŠ¨åˆ›å»ºé‡‘è¶é…ç½®å‚æ•°</p></li></ol> <p>2.Libï¼š</p> <p>â€‹		<code>redislib.py</code>: def handle_redis_tokenå­˜å‚¨è®¾ç½®tokençš„æœ‰æ•ˆæ—¶é•¿ä¸º4å°æ—¶ï¼Œè¿‡æœŸè‡ªåŠ¨åˆ é™¤</p> <p>â€‹	3.Models:</p> <p>â€‹		==rh_kingdee_port.py==é›†æˆé‡‘è¶æ‰€æœ‰æ¨¡å‹å’Œæ¥å£</p> <p>â€‹		==rh_kingdee_send_logs.py==ï¼šé‡‘è¶åŒæ­¥æ—¥å¿—</p> <p>â€‹		==account_payment_interface.py==ï¼šé›†æˆæ”¶ä»˜æ¬¾æ¨é€åŠŸèƒ½</p> <p>â€‹		==inhert_hr_sheet.py==ï¼šè´¹ç”¨æ¨é€</p> <p>â€‹		==rh_inherit_company.py==ï¼šè¾“å…¥å…¬å¸åç§°ï¼Œè·å–å¸æ— å¿§å¯¹åº”çš„å®¢æˆ·ç¼–å·ç”¨äºåŒæ­¥æ¥å£</p> <p>â€‹		==rh_kingdee_category.py==ï¼šé‡‘è¶ç¥¨æ®ç±»å‹å’Œå‡­è¯æ¨¡ç‰ˆå­˜æ”¾çš„æ¨¡å‹è¡¨</p> <p>â€‹		<code>é‡‘è¶é…ç½®</code>æ˜¯é€šè¿‡yamlæ–‡ä»¶å¯¼å…¥ç”Ÿæˆçš„</p> <p>â€‹	4.<code>wizard</code></p> <p>â€‹		push_account_sheet_wizard.py ï¼šè´¹ç”¨æ¨é€å‘å¯¼</p> <p>â€‹		push_expense_sheet_wizard.pyï¼šæ”¶ä»˜æ¬¾å‘å¯¼</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">Kingdee_Port_set</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">test_kingdee_connection</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#æµ‹è¯•é“¾æ¥å¹¶å°†tokenä¿å­˜åˆ°rediså½“ä¸­</span>
    <span class="token keyword">def</span> <span class="token function">check_redis_token</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token comment">#æ£€æŸ¥tokeèƒ½æœ‰æ•ˆæ€§ï¼Œæœ‰åˆ™è·å–ï¼Œæ— åˆ™é‡æ–°è°ƒç”¨test_kingdee_connection</span>
    <span class="token keyword">def</span> <span class="token function">get_kingdee_category</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token comment">#è·å–ç¥¨æ®ç±»å‹</span>
    <span class="token keyword">def</span> <span class="token function">get_account_rule</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#è·å–å‡­è¯æ¨¡ç‰ˆ</span>
    <span class="token keyword">def</span> <span class="token function">batch_push_documents</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#æ¨é€å•æ®åˆ°å¸æ— å¿§æ™ºèƒ½è®°è´¦</span>
    <span class="token keyword">def</span> <span class="token function">get_report_account</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#è·å–é“¶è¡Œç§‘ç›®</span>
    
</code></pre></div><h3 id="ç™¾åº¦è¡Œæ”¿ç¼–å—"><a href="#ç™¾åº¦è¡Œæ”¿ç¼–å—" class="header-anchor">#</a> ç™¾åº¦è¡Œæ”¿ç¼–å—</h3> <p>â€‹	1.<code>Models</code>:address_maintenance.py</p> <p>â€‹		è°ƒå–APiæ¥å£ï¼Œåˆ†åˆ«ä¸ºçœã€å¸‚ã€åŒºã€ä¹¡é•‡è¡—é“(ç›®å‰åªæœ‰åŒ—äº¬å’Œä¸Šæµ·)å†™å…¥åç§°å’Œè¡Œæ”¿ç¼–å—</p> <p>â€‹	2.<code>Views</code>:address_import.xml</p> <p>â€‹		é™åˆ¶åŸæ¨¡å‹çš„åˆ›å»ºä¿®æ”¹</p> <h3 id="çŸ­ä¿¡å¹³å°"><a href="#çŸ­ä¿¡å¹³å°" class="header-anchor">#</a> çŸ­ä¿¡å¹³å°</h3> <p>â€‹	1.<code>Models</code>:compressed_link.py</p> <p>â€‹		å¤§æ±‰ä¸‰é€šçŸ­é“¾æ¥ def set_short_url</p> <p>â€‹		inherit_workflow_config_settings.py ç»§æ‰¿åŸºç¡€é…ç½®æ¨¡å‹ï¼Œå†™å…¥çŸ­ä¿¡URLï¼Œè´¦å·ã€å¯†ç </p> <p>â€‹		send_message.py ï¼šçŸ­ä¿¡æ¨¡ç‰ˆå’Œæ¥å£è°ƒç”¨</p> <h3 id="è‡ªç”±ç­¾"><a href="#è‡ªç”±ç­¾" class="header-anchor">#</a> è‡ªç”±ç­¾</h3> <p>1.<code>Models</code></p> <p>â€‹	<code>Fields</code>:sign_process_id :ç­¾ç½²æµç¨‹IDï¼Œsignatory_idsï¼šç­¾ç½²æ–¹åˆ—è¡¨ï¼Œcurrent_signatory_idï¼šå½“å‰ç­¾ç½²äººï¼Œ</p> <p>â€‹	history_signatory_idï¼šå‘èµ·ç­¾ç½²çš„äººï¼ˆç¬¬ä¸€ï¼‰</p> <ul><li>==free_sale.py==:ç”µå­ç­¾çº¦æ·»åŠ ç­¾ç½²æ–¹</li></ul> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">init_send_sign_msg</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#å½“å‰ç­¾ç½²äººå¿…é¡»æ˜¯ä¼ä¸šå½“å‰ç­¾ç½²äººï¼Œåˆå§‹åŒ–ç­¾ç½²çš„ç¯å¢ƒï¼Œ`å¤šç­¾`å¿…é¡»æ³•äººç¡®è®¤çŸ­ä¿¡ï¼Œ`å•ç­¾`æ— éœ€ç¡®è®¤</span>
    <span class="token keyword">if</span> party_partner_obj<span class="token punctuation">.</span>org_id<span class="token punctuation">.</span><span class="token builtin">id</span> <span class="token operator">!=</span> <span class="token boolean">False</span><span class="token punctuation">:</span> <span class="token comment">#ä»£è¡¨ä¼ä¸šç­¾ç½²</span>
        <span class="token keyword">if</span> sign_partner_obj<span class="token punctuation">.</span><span class="token builtin">id</span> <span class="token operator">!=</span> legal_person_partner_obj<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">:</span> <span class="token comment">#å½“å‰ç­¾ç½²äººä¸æ˜¯æ³•äºº</span>
            flag <span class="token operator">=</span> <span class="token boolean">True</span>
            <span class="token keyword">if</span> signing_method <span class="token operator">==</span> <span class="token string">'multi_signature'</span><span class="token punctuation">:</span> <span class="token comment">#å¤šç­¾</span>
                party_obj<span class="token punctuation">.</span>auth_state <span class="token operator">=</span> <span class="token string">'start_auth'</span>
                result <span class="token operator">=</span> tool<span class="token punctuation">.</span>send_msg_to_legal_person_for_sign<span class="token punctuation">(</span>model_str<span class="token punctuation">,</span> record_id<span class="token punctuation">,</span> party_obj<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span>time_stamp<span class="token punctuation">,</span> sign_partner_obj<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        party_obj<span class="token punctuation">.</span>auth_state <span class="token operator">=</span> <span class="token string">'person'</span> <span class="token comment">#ä¸ªäººç­¾ç½²</span>
                                                                

<span class="token keyword">def</span> <span class="token function">send_sign_msg</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#å‘èµ·ç­¾çº¦è°ƒç”¨eç­¾å®é™é»˜ç­¾ç½²	 </span>
                   flow_num<span class="token punctuation">,</span>body_json<span class="token operator">=</span>util<span class="token punctuation">.</span>util_send_sale_signature<span class="token punctuation">(</span>data<span class="token punctuation">,</span>name<span class="token punctuation">,</span>sign_list<span class="token punctuation">,</span><span class="token string">'sign_free_sale'</span><span class="token punctuation">,</span>model<span class="token operator">=</span><span class="token string">'free.sale'</span><span class="token punctuation">,</span>record_id<span class="token operator">=</span>self<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">)</span> <span class="token comment">#æ„é€ ç­¾ç½²æ–¹åˆ—è¡¨æ‰€éœ€çš„ç¯å¢ƒå˜é‡</span>
        field_list <span class="token operator">=</span> handler<span class="token punctuation">.</span>find_sign_field_based_on_flow_num<span class="token punctuation">(</span>flow_num<span class="token operator">=</span>flow_num<span class="token punctuation">,</span>lighthouse<span class="token operator">=</span>lighthouse<span class="token punctuation">)</span>
        
</code></pre></div><ul><li><p>==def send_sign_msg==ï¼šä¸ºè‡ªç”±ç­¾åˆ†ç±»ä¸ºï¼Œå•ç­¾å’Œå¤šç­¾ï¼Œåœ¨XML contextä¸­é»˜è®¤<code>def create_signer</code>å•ç­¾è‡ªåŠ¨å¸¦å‡ºå½“å‰å…¬å¸çš„å½“å‰ç­¾ç½²äººï¼Œ<code>def action_opt_sign_warning</code>æ²¡æœ‰ç­¾ç½²äººå¼¹å‡ºæé†’ ï¼Œ<code>def do_submit</code>ç›´æ¥åˆ›å»ºç­¾ç½²æ–¹ï¼Œ<code>notify_signer_msg</code>:èµ°å®Œå®¡æ‰¹æµå‘é€çŸ­ä¿¡</p></li> <li><p><code>single_sign.py</code>: å­—æ®µï¼šsigning_method ï¼šã€'single_sign':å•ç­¾ï¼Œ'multi_signature':å¤šç­¾ã€‘</p> <p><code>def create_signer</code>:å•ç­¾è‡ªåŠ¨åˆ›å»ºç­¾ç½²æ–¹åˆ—è¡¨æ–¹æ³•</p> <p><code>def _compute_belong_singer</code>:æ ¹æ®current_signatory_id,åˆ¤æ–­å½“å‰ç­¾ç½²äººå’Œç™»å½•idæ˜¯å¦ä¸€è‡´</p></li> <li><p><code>free_sign_popup_reminder.py</code>:ç­¾ç½²æ–¹åˆ—è¡¨ä¸ºç©ºæ—¶ï¼Œå¼¹å‡ºå‘å¯¼çš„wizardæ–¹æ³•</p></li></ul> <p>2.<code>Controllers</code></p> <p>â€‹	==controllers.py==: <code>/sign/process/free_sale</code>è¿™ä¸ªè·¯ç”±æ˜¯ç”¨æ¥è‡ªç”±ç­¾ç½²å›è°ƒï¼Œæ›´æ”¹æœ¬åœ°çš„çŠ¶æ€</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">5/14/2023, 12:30:43 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/è¶…é«˜æ¸…èƒ½åŠ›/æ¬è¿ç»„ä»¶è¯´æ˜æ–‡æ¡£.html" class="prev">
        æ¬è¿ç»„ä»¶è¯´æ˜æ–‡æ¡£
      </a></span> <span class="next"><a href="/è¶…é«˜æ¸…èƒ½åŠ›/DTing VQMT VQAéƒ¨ç½²å¸¸è§é—®é¢˜.html">
        DTing VQMT VQAéƒ¨ç½²å¸¸è§é—®é¢˜
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.449b22a3.js" defer></script><script src="/assets/js/2.559d5401.js" defer></script><script src="/assets/js/15.ec9227b5.js" defer></script>
  </body>
</html>
